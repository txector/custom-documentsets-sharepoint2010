The code sample illustrates how to provision custom Document Sets in SharePoint 2010 with CAML.
The solution contains definition of Document Set and list instance, which is associated with the custom document set for content type.
The edit form of the Document Set is customized with rendering template and its save behavior is customized.

You can find the related articles at:
http://kbochevski.blogspot.com/2011/07/provision-custom-document-sets-with.html
http://kbochevski.blogspot.com/2011/07/customizing-rendering-templates-for.html